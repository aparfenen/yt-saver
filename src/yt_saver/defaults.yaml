# Global defaults (safe & stable)
save_dir: "./downloads"

# Filename: date always, time if present, short safe title
outtmpl: "%(upload_date>%Y-%m-%d)s%(release_timestamp>_%H-%M-%S|)s - %(autonumber)02d - %(title).100s.%(ext)s"

# Common network/robustness
network:
  retries: 10
  fragment_retries: 10
  retry_sleep: "http:exp=1:30,fragment:exp=1:20"
  concurrent_fragment_downloads: 3
  socket_timeout: 30
  skip_unavailable_fragments: true
  sleep_requests: 1.2
  max_sleep_interval: 20

# Common behavior
behavior:
  noplaylist: true
  continuedl: true
  overwrites: false
  windowsfilenames: true
  check_formats: true
  no_warnings: true
  ignoreerrors: true
  no_abort_on_error: true
  download_archive: "yt-dlp-archive.txt"

# Subtitles / metadata (base defaults; profiles may override)
media:
  writeinfojson: true
  writethumbnail: false        # base: off (profiles may turn on)
  embedthumbnail: false        # base: off (profiles may turn on)
  addmetadata: true
  embedsubtitles: false        # base: off (profiles may turn on)
  writesubtitles: true         # base: download text subs
  writeautomaticsub: true
  subtitleslangs: ["en", "ru"] # keep only main langs to avoid en-en/en-orig
  subtitlesformat: "vtt"       # profiles can request convertâ†’srt
  # convertsubtitles: "srt"    # only set in profiles that need it

# Advanced
advanced:
  outtmpl_na_placeholder: "NA"

# Subdirectory templates used by the wrapper (not yt-dlp)
subdirs:
  per_item: "%(title).80s [%(id)s]"
  per_playlist: "%(playlist_title).80s [%(playlist_id)s]"

# Profiles tweak format/container and media handling
profiles:
  webm:
    format: "bv*[ext=webm]+ba[ext=webm]/bv*+ba/best"
    merge_output_format: "webm"
    remuxvideo: "webm"
    writethumbnail: true
    embedthumbnail: true
    embedsubtitles: true

  mp4:
    # prefer h264/aac for max compatibility
    format: "bv*[vcodec*=avc1]+ba[acodec*=mp4a]/bv*+ba/best"
    merge_output_format: "mp4"
    remuxvideo: "mp4"
    writethumbnail: true
    embedthumbnail: true
    embedsubtitles: true

  mkv:  # archival: embed everything, force SRT for best player support
    format: "bv*+ba/best"
    merge_output_format: "mkv"
    remuxvideo: "mkv"

    writesubtitles: true
    embedsubtitles: true
    subtitlesformat: "vtt/srt"     # download whatever exists
    convertsubtitles: "srt"        # convert to SRT before embedding

    writethumbnail: true
    embedthumbnail: true

    # Force exact post-processing steps
    postprocessors:
      - key: FFmpegSubtitlesConvertor
        format: srt
      - key: FFmpegEmbedSubtitle
      - key: EmbedThumbnail

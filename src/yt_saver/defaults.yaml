# Global defaults (safe & stable)
save_dir: "./downloads"

# Filename: date always, time if present, short safe title
outtmpl: "%(upload_date>%Y-%m-%d)s%(release_timestamp>_%H-%M-%S|)s - %(autonumber)02d - %(title).100s.%(ext)s"

# Common network/robustness
network:
  retries: 10
  fragment_retries: 10
  retry_sleep: "http:exp=1:30,fragment:exp=1:20"
  concurrent_fragment_downloads: 3
  socket_timeout: 30
  skip_unavailable_fragments: true
  sleep_requests: 1.2
  max_sleep_interval: 20

# Common behavior
behavior:
  noplaylist: true
  continuedl: true
  overwrites: false
  windowsfilenames: true
  check_formats: true
  no_warnings: true
  ignoreerrors: true
  no_abort_on_error: true
  download_archive: "yt-dlp-archive.txt"

# Subtitles/metadata (база; профили переопределят при необходимости)
media:
  writeinfojson: true
  writethumbnail: true      # сохраняем файл миниатюры на диск
  embedthumbnail: false     # для видео-контейнеров ведёт себя нестабильно — отключаем
  addmetadata: true

  # База: НЕ трогаем субтитры (пусть профили решают)
  writesubtitles: false
  writeautomaticsub: true
  embedsubtitles: false
  subtitleslangs: ["en", "ru"]
  subtitlesformat: "vtt/srt"

advanced:
  outtmpl_na_placeholder: "NA"

subdirs:
  per_item: "%(title).80s [%(id)s]"
  per_playlist: "%(playlist_title).80s [%(playlist_id)s]"

# Profiles
profiles:
  # Качество/современные кодеки, без сайдкаров и попыток embed (во избежание .srt)
  webm:
    format: "bv*[ext=webm]+ba[ext=webm]/bv*+ba/best"
    merge_output_format: "webm"
    remuxvideo: "webm"
    writesubtitles: false
    embedsubtitles: false

  # Максимальная совместимость + встраивание srt внутрь MKV
  mkv:
    format: "bv*+ba/best"
    merge_output_format: "mkv"
    remuxvideo: "mkv"
    writesubtitles: true
    embedsubtitles: true
    subtitlesformat: "vtt/srt"
    convertsubtitles: "srt"
    postprocessors:
      - key: FFmpegSubtitlesConvertor
        format: srt
      - key: FFmpegEmbedSubtitle
